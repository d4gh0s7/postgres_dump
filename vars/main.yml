---
# vars file for postgres_dump

# Dynamically determined within the main task
# postgresql version is stored in format: Major.Minor
# This variable is merely used to determine the path of the postgresql backups folder;
# set it manually only if you know what you are doing.
postgresql_version: 0

provision_temporary_user_grant_privileges_commands:
  - GRANT SELECT ON ALL TABLES IN SCHEMA pg_catalog TO {{ postgresql_backup_executor }}
  - GRANT SELECT, USAGE ON ALL SEQUENCES IN SCHEMA pg_catalog TO {{ postgresql_backup_executor }}

# - name: Alter temporary user
#   command: psql --command="ALTER DEFAULT PRIVILEGES IN SCHEMA pg_catalog GRANT SELECT ON TABLES TO {{ random_username.stdout }};"

# - name: Alter temporary user
#   command: psql --command="ALTER DEFAULT PRIVILEGES IN SCHEMA pg_catalog GRANT SELECT, USAGE ON SEQUENCES TO {{ random_username.stdout }};"

provision_temporary_user_revoke_privileges_commands:
  - REVOKE ALL PRIVILEGES ON ALL TABLES IN SCHEMA pg_catalog FROM {{ postgresql_backup_executor }}
  - REVOKE ALL PRIVILEGES ON ALL SEQUENCES IN SCHEMA pg_catalog FROM {{ postgresql_backup_executor }}
...